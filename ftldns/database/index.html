



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
        <link rel="canonical" href="https://docs.pi-hole.net/ftldns/database/">
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.2.0">
    
    
      
        <title>Long-term database - Pi-hole documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.750b69bd.css">
      
      
    
    
      <script src="../../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../extra.css">
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#split-database" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://docs.pi-hole.net" title="Pi-hole documentation" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Pi-hole documentation
            </span>
            <span class="md-header-nav__topic">
              Long-term database
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/pi-hole/pi-hole/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://docs.pi-hole.net" title="Pi-hole documentation" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Pi-hole documentation
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/pi-hole/pi-hole/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      About Pi-hole
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        About Pi-hole
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../main/contact/" title="Contact Us" class="md-nav__link">
      Contact Us
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../main/origins/" title="Pi-hole Origins" class="md-nav__link">
      Pi-hole Origins
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../main/presentations/" title="Presentation Support" class="md-nav__link">
      Presentation Support
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../main/coverage/" title="On the Web" class="md-nav__link">
      On the Web
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Getting Started
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Getting Started
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../main/prerequesites/" title="Prerequisites" class="md-nav__link">
      Prerequisites
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../main/basic-install/" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../main/post-install/" title="Post-Install" class="md-nav__link">
      Post-Install
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../main/update/" title="Updating" class="md-nav__link">
      Updating
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Pi-hole Core
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Pi-hole Core
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../core/pihole-command/" title="The pihole command" class="md-nav__link">
      The <samp>pihole</samp> command
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5" checked>
    
    <label class="md-nav__link" for="nav-5">
      FTLDNS
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        FTLDNS
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../configfile/" title="Configuration" class="md-nav__link">
      Configuration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dns-resolver/" title="DNS resolver" class="md-nav__link">
      DNS resolver
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dns-cache/" title="DNS cache" class="md-nav__link">
      DNS cache
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../blockingmode/" title="Blocking mode" class="md-nav__link">
      Blocking mode
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-6" type="checkbox" id="nav-5-6">
    
    <label class="md-nav__link" for="nav-5-6">
      RegEx blocking
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-6">
        RegEx blocking
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../regex/overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../regex/tutorial/" title="Tutorial" class="md-nav__link">
      Tutorial
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../privacylevels/" title="Privacy levels" class="md-nav__link">
      Privacy levels
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Long-term database
      </label>
    
    <a href="./" title="Long-term database" class="md-nav__link md-nav__link--active">
      Long-term database
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#split-database" title="Split database" class="md-nav__link">
    Split database
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backup-database" title="Backup database" class="md-nav__link">
    Backup database
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#query-table" title="Query Table" class="md-nav__link">
    Query Table
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#counters-table" title="Counters table" class="md-nav__link">
    Counters table
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ftl-table" title="FTL table" class="md-nav__link">
    FTL table
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#supported-query-types" title="Supported query types" class="md-nav__link">
    Supported query types
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#supported-status-types" title="Supported status types" class="md-nav__link">
    Supported status types
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-for-interaction-with-the-ftl-long-term-database" title="Example for interaction with the FTL long-term database" class="md-nav__link">
    Example for interaction with the FTL long-term database
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../telnet-api/" title="Telnet API" class="md-nav__link">
      Telnet API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../compatibility/" title="Compatibility" class="md-nav__link">
      Compatibility
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../compile/" title="Install from source" class="md-nav__link">
      Install from source
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../debugging/" title="Debugging FTLDNS" class="md-nav__link">
      Debugging FTLDNS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../in-depth/" title="In-depth manual" class="md-nav__link">
      In-depth manual
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Docker
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Docker
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../docker/DHCP/" title="DHCP" class="md-nav__link">
      DHCP
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Contributing
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Contributing
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../guides/github/contributing/" title="Contributing on Github" class="md-nav__link">
      Contributing on Github
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guides/github/how-to-signoff/" title="How to sign-off commits" class="md-nav__link">
      How to sign-off commits
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      Guides
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        Guides
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../guides/unbound/" title="Pi-hole as All-Around DNS Solution" class="md-nav__link">
      Pi-hole as All-Around DNS Solution
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guides/dns-over-https/" title="Configuring DNS-Over-HTTPS on Pi-hole" class="md-nav__link">
      Configuring DNS-Over-HTTPS on Pi-hole
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guides/upstream-dns-providers/" title="Upstream DNS Providers" class="md-nav__link">
      Upstream DNS Providers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guides/whitelist-blacklist/" title="Editing Whitelist and Blacklist" class="md-nav__link">
      Editing Whitelist and Blacklist
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guides/nginx-configuration/" title="Configuring NGINX for Pi-hole" class="md-nav__link">
      Configuring NGINX for Pi-hole
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guides/caddy-configuration/" title="Configuring Caddy for Pi-hole" class="md-nav__link">
      Configuring Caddy for Pi-hole
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guides/traefik-configuration-nodocker/" title="Configuring Traefik for Pi-hole (not in Docker)" class="md-nav__link">
      Configuring Traefik for Pi-hole (not in Docker)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-8" type="checkbox" id="nav-8-8">
    
    <label class="md-nav__link" for="nav-8-8">
      Pi-hole and OpenVPN Server
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-8-8">
        Pi-hole and OpenVPN Server
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../guides/vpn/overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guides/vpn/installation/" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guides/vpn/setup-openvpn-server/" title="Setup OpenVPN Server" class="md-nav__link">
      Setup OpenVPN Server
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guides/vpn/firewall/" title="Firewall Configuration" class="md-nav__link">
      Firewall Configuration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-8-5" type="checkbox" id="nav-8-8-5">
    
    <label class="md-nav__link" for="nav-8-8-5">
      Connecting clients
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-8-8-5">
        Connecting clients
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../guides/vpn/clients/" title="General" class="md-nav__link">
      General
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guides/vpn/android-client/" title="Android" class="md-nav__link">
      Android
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guides/vpn/only-dns-via-vpn/" title="Optional: Only route DNS via VPN" class="md-nav__link">
      Optional: Only route DNS via VPN
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guides/vpn/dual-operation/" title="Optional: Dual operation: LAN & VPN at the same time" class="md-nav__link">
      Optional: Dual operation: LAN & VPN at the same time
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guides/vpn/dual-VPN/" title="Optional: Full and DNS-only" class="md-nav__link">
      Optional: Full and DNS-only
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guides/vpn/dynDNS/" title="Optional: Dynamic DNS" class="md-nav__link">
      Optional: Dynamic DNS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guides/vpn/troubleshooting/" title="Troubleshooting" class="md-nav__link">
      Troubleshooting
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-9" type="checkbox" id="nav-8-9">
    
    <label class="md-nav__link" for="nav-8-9">
      TOR & Pi-hole
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-8-9">
        TOR & Pi-hole
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../guides/tor/overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guides/tor/setup/" title="Basic Setup" class="md-nav__link">
      Basic Setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guides/tor/using-tor/" title="Using TOR" class="md-nav__link">
      Using TOR
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guides/tor/performance-issues/" title="Performance and other issues" class="md-nav__link">
      Performance and other issues
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../guides/tor/dnssec/" title="Using DNSSEC" class="md-nav__link">
      Using DNSSEC
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../main/projects/" title="Community Projects" class="md-nav__link">
      Community Projects
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#split-database" title="Split database" class="md-nav__link">
    Split database
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backup-database" title="Backup database" class="md-nav__link">
    Backup database
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#query-table" title="Query Table" class="md-nav__link">
    Query Table
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#counters-table" title="Counters table" class="md-nav__link">
    Counters table
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ftl-table" title="FTL table" class="md-nav__link">
    FTL table
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#supported-query-types" title="Supported query types" class="md-nav__link">
    Supported query types
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#supported-status-types" title="Supported status types" class="md-nav__link">
    Supported status types
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-for-interaction-with-the-ftl-long-term-database" title="Example for interaction with the FTL long-term database" class="md-nav__link">
    Example for interaction with the FTL long-term database
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Long-term database</h1>
                
                <p>Pi-hole <em><abbr title="Pi-hole's Faster Than Light daemon">FTL</abbr></em><abbr title="Domain Name Service (decentralized naming system for computers, services, or other resources connected to the Internet)">DNS</abbr> uses the well-known relational database management system <abbr title="Database engine that handles an SQL databases in a file">SQLite3</abbr> as its long-term storage of query data. In contrast to many other database management solutions, <em><abbr title="Pi-hole's Faster Than Light daemon">FTL</abbr></em><abbr title="Domain Name Service (decentralized naming system for computers, services, or other resources connected to the Internet)">DNS</abbr> does not need a server database engine as the database engine is directly embedded in <em><abbr title="Pi-hole's Faster Than Light daemon">FTL</abbr></em><abbr title="Domain Name Service (decentralized naming system for computers, services, or other resources connected to the Internet)">DNS</abbr>. It seems an obvious choice as it is probably the most widely deployed database engine - it is used today by several widespread web browsers, operating systems, and embedded systems (such as mobile phones), among others. Hence, it is rich in supported platforms and offered features. SQLite implements most of the SQL-92 standard for SQL and can be used for high-level queries.</p>
<p>We update the database file periodically and on exit of <em><abbr title="Pi-hole's Faster Than Light daemon">FTL</abbr></em><abbr title="Domain Name Service (decentralized naming system for computers, services, or other resources connected to the Internet)">DNS</abbr> (triggered e.g. by a <code>service pihole-FTL restart</code>). The updating frequency can be controlled by the parameter <a href="../configfile/#dbinterval"><code>DBINTERVAL</code></a> and defaults to once per minute. We think this interval is sufficient to protect against data losses due to power failure events. <em><abbr title="Pi-hole's Faster Than Light daemon">FTL</abbr></em><abbr title="Domain Name Service (decentralized naming system for computers, services, or other resources connected to the Internet)">DNS</abbr> needs the database to populate its internal history of the most recent 24 hours. If the database is disabled, <em><abbr title="Pi-hole's Faster Than Light daemon">FTL</abbr></em><abbr title="Domain Name Service (decentralized naming system for computers, services, or other resources connected to the Internet)">DNS</abbr> will show an empty query history after a restart.</p>
<p>The location of the database can be configures by the config parameter <a href="../configfile/#dbfile"><code>DBFILE</code></a>. It defaults to <code>/etc/pihole/pihole-FTL.db</code>. If the given file does not exist, <em><abbr title="Pi-hole's Faster Than Light daemon">FTL</abbr></em><abbr title="Domain Name Service (decentralized naming system for computers, services, or other resources connected to the Internet)">DNS</abbr> will create a new (empty) database file.</p>
<p>Another way of controlling the size of the long-term database is setting a maximum age for log queries to keep using the config parameter <a href="../configfile/#maxdbdays"><code>MAXDBDAYS</code></a>. It defaults to 365 days, i.e. queries that are older than one year get periodically removed to limit the growth of the long-term database file.</p>
<p>The config parameter <a href="../configfile/#dbimport"><code>DBIMPORT</code></a> controls whether <code>FTL</code> loads information from the database on startup. It need to do this to populate the internal datastructure with the most recent history. However, as importing from the database on disk can delay <abbr title="Pi-hole's Faster Than Light daemon">FTL</abbr> on very large deploys, it can be disabled using this option.</p>
<hr />
<h3 id="split-database">Split database<a class="headerlink" href="#split-database" title="Permanent link">&para;</a></h3>
<p>You can split your long-term database by periodically rotating the database file (do this only when <code>pihole-FTL</code> is <em>not</em> running). The individual database contents can easily be merged when required.
This could be implemented by running a monthly <code>cron</code> job such as:
<div class="codehilite"><pre><span></span><span class="n">sudo</span> <span class="n">service</span> <span class="n">pihole</span><span class="o">-</span><span class="n">FTL</span> <span class="n">stop</span>
<span class="n">sudo</span> <span class="n">mv</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">pihole</span><span class="o">/</span><span class="n">pihole</span><span class="o">-</span><span class="n">FTL</span><span class="p">.</span><span class="n">db</span> <span class="o">/</span><span class="n">media</span><span class="o">/</span><span class="n">backup</span><span class="o">/</span><span class="n">pihole</span><span class="o">-</span><span class="n">FTL_$</span><span class="p">(</span><span class="nb">date</span> <span class="o">+</span><span class="ss">&quot;%m-%y&quot;</span><span class="p">).</span><span class="n">db</span>
<span class="n">sudo</span> <span class="n">service</span> <span class="n">pihole</span><span class="o">-</span><span class="n">FTL</span> <span class="k">start</span>
</pre></div>
Note that <abbr title="Domain Name Service (decentralized naming system for computers, services, or other resources connected to the Internet)">DNS</abbr> resolution will not be available as long as <code>pihole-FTL</code> is stopped.</p>
<h3 id="backup-database">Backup database<a class="headerlink" href="#backup-database" title="Permanent link">&para;</a></h3>
<p>The database can be backed up while <abbr title="Pi-hole's Faster Than Light daemon">FTL</abbr> is running when using the <abbr title="Database engine that handles an SQL databases in a file">SQLite3</abbr> Online backup method, e.g.,
<div class="codehilite"><pre><span></span><span class="n">sqlite3</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">pihole</span><span class="o">/</span><span class="n">pihole</span><span class="o">-</span><span class="n">FTL</span><span class="p">.</span><span class="n">db</span> <span class="ss">&quot;.backup /home/pi/pihole-FTL.db.backup&quot;</span>
</pre></div>
will create <code>/home/pi/pihole-FTL.db.backup</code> which is a copy of your long-term database.</p>
<hr />
<p>The long-term database contains three tables:</p>
<h3 id="query-table">Query Table<a class="headerlink" href="#query-table" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Label</th>
<th>Type</th>
<th>Allowed to by empty</th>
<th>Content</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id</code></td>
<td>integer</td>
<td>No</td>
<td>autoincrement <abbr title="Indentifier">ID</abbr> for the table, only used by <abbr title="Database engine that handles an SQL databases in a file">SQLite3</abbr>, not by <em><abbr title="Pi-hole's Faster Than Light daemon">FTL</abbr></em><abbr title="Domain Name Service (decentralized naming system for computers, services, or other resources connected to the Internet)">DNS</abbr></td>
</tr>
<tr>
<td><code>timestamp</code></td>
<td>integer</td>
<td>No</td>
<td>Unix timestamp when this query arrived at <em><abbr title="Pi-hole's Faster Than Light daemon">FTL</abbr></em><abbr title="Domain Name Service (decentralized naming system for computers, services, or other resources connected to the Internet)">DNS</abbr> (used as index)</td>
</tr>
<tr>
<td><code>type</code></td>
<td>integer</td>
<td>No</td>
<td>Type of this query (see <a href="./#supported-query-types">Supported query types</a>)</td>
</tr>
<tr>
<td><code>status</code></td>
<td>integer</td>
<td>No</td>
<td>How was this query handled by <em><abbr title="Pi-hole's Faster Than Light daemon">FTL</abbr></em><abbr title="Domain Name Service (decentralized naming system for computers, services, or other resources connected to the Internet)">DNS</abbr>? (see <a href="./#supported-status-types">Supported status types</a>)</td>
</tr>
<tr>
<td><code>domain</code></td>
<td>text</td>
<td>No</td>
<td>Requested domain</td>
</tr>
<tr>
<td><code>client</code></td>
<td>text</td>
<td>No</td>
<td>Requesting client (<abbr title="Internet protocol address">IP</abbr> address)</td>
</tr>
<tr>
<td><code>forward</code></td>
<td>text</td>
<td>Yes</td>
<td>Forward destination used for this query (only set if <code>status == 2</code>)</td>
</tr>
</tbody>
</table>
<p><abbr title="Database engine that handles an SQL databases in a file">SQLite3</abbr> syntax used to create this table:
<div class="codehilite"><pre><span></span><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">queries</span> <span class="p">(</span> <span class="n">id</span> <span class="nb">INTEGER</span> <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="n">AUTOINCREMENT</span><span class="p">,</span> <span class="k">timestamp</span> <span class="nb">INTEGER</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">type</span> <span class="nb">INTEGER</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span> <span class="n">status</span> <span class="nb">INTEGER</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">domain</span> <span class="nb">TEXT</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span> <span class="n">client</span> <span class="nb">TEXT</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">forward</span> <span class="nb">TEXT</span> <span class="p">);</span>
<span class="k">CREATE</span> <span class="k">INDEX</span> <span class="n">idx_queries_timestamps</span> <span class="k">ON</span> <span class="n">queries</span> <span class="p">(</span><span class="k">timestamp</span><span class="p">);</span>
</pre></div></p>
<h3 id="counters-table">Counters table<a class="headerlink" href="#counters-table" title="Permanent link">&para;</a></h3>
<p>This table contains counter values integrated over the entire lifetime of the table</p>
<table>
<thead>
<tr>
<th>Label</th>
<th>Type</th>
<th>Allowed to by empty</th>
<th>Content</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id</code></td>
<td>integer</td>
<td>No</td>
<td><abbr title="Indentifier">ID</abbr> for the table used to select a counter (see below)</td>
</tr>
<tr>
<td><code>value</code></td>
<td>integer</td>
<td>No</td>
<td>Value of a given counter</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>Counter <abbr title="Indentifier">ID</abbr></th>
<th>Interpretation</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>Total number of queries</td>
</tr>
<tr>
<td>1</td>
<td>Total number of blocked queries (Query <code>status</code> 1, 4 or 5)</td>
</tr>
</tbody>
</table>
<p><abbr title="Database engine that handles an SQL databases in a file">SQLite3</abbr> syntax used to create this table:
<div class="codehilite"><pre><span></span><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">counters</span> <span class="p">(</span> <span class="n">id</span> <span class="nb">INTEGER</span> <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span> <span class="n">value</span> <span class="nb">INTEGER</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="p">);</span>
</pre></div></p>
<h3 id="ftl-table"><abbr title="Pi-hole's Faster Than Light daemon">FTL</abbr> table<a class="headerlink" href="#ftl-table" title="Permanent link">&para;</a></h3>
<p>The <abbr title="Pi-hole's Faster Than Light daemon">FTL</abbr> tables contains some data used by <em><abbr title="Pi-hole's Faster Than Light daemon">FTL</abbr></em><abbr title="Domain Name Service (decentralized naming system for computers, services, or other resources connected to the Internet)">DNS</abbr> for determining which queries to save to the database. This table does not contain any entries of general interest.</p>
<p><abbr title="Database engine that handles an SQL databases in a file">SQLite3</abbr> syntax used to create this table:
<div class="codehilite"><pre><span></span><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">ftl</span> <span class="p">(</span> <span class="n">id</span> <span class="nb">INTEGER</span> <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span> <span class="n">value</span> <span class="nb">BLOB</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="p">);</span>
</pre></div></p>
<h3 id="supported-query-types">Supported query types<a class="headerlink" href="#supported-query-types" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th><abbr title="Indentifier">ID</abbr></th>
<th>Query Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>A</td>
</tr>
<tr>
<td>2</td>
<td>AAAA</td>
</tr>
<tr>
<td>3</td>
<td>ANY</td>
</tr>
<tr>
<td>4</td>
<td>SRV</td>
</tr>
<tr>
<td>5</td>
<td>SOA</td>
</tr>
<tr>
<td>6</td>
<td>PTR</td>
</tr>
<tr>
<td>7</td>
<td>TXT</td>
</tr>
</tbody>
</table>
<!-- ID | 1 | 2 | 3 | 4 | 5 | 6 | 7 -->

<!-- -- | -- | -- | -- | -- | -- | -- | -- -->

<!-- Query | A | AAAA | ANY | SRV | SOA | PTR | TXT -->

<h3 id="supported-status-types">Supported status types<a class="headerlink" href="#supported-status-types" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th><abbr title="Indentifier">ID</abbr></th>
<th>Query Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>Unknown status (was not answered by forward destination)</td>
</tr>
<tr>
<td>1</td>
<td>Blocked by <code>gravity.list</code></td>
</tr>
<tr>
<td>2</td>
<td>Permitted + forwarded</td>
</tr>
<tr>
<td>3</td>
<td>Permitted + replied to from cache</td>
</tr>
<tr>
<td>4</td>
<td>Blocked by wildcard</td>
</tr>
<tr>
<td>5</td>
<td>Blocked by <code>black.list</code></td>
</tr>
<tr>
<td>6</td>
<td>Blocked by upstream server (known blocking page <abbr title="Internet protocol address">IP</abbr> address)</td>
</tr>
<tr>
<td>7</td>
<td>Blocked by upstream server (<code>0.0.0.0</code> or <code>::</code>)</td>
</tr>
<tr>
<td>8</td>
<td>Blocked by upstream server (<code>NXDOMAIN</code> with <code>RA</code> bit unset)</td>
</tr>
</tbody>
</table>
<h3 id="example-for-interaction-with-the-ftl-long-term-database">Example for interaction with the <abbr title="Pi-hole's Faster Than Light daemon">FTL</abbr> long-term database<a class="headerlink" href="#example-for-interaction-with-the-ftl-long-term-database" title="Permanent link">&para;</a></h3>
<p>In addition to the interactions the Pi-hole database <abbr title="Application Programming Interface (a set of subroutine definitions, protocols, and tools for building application software)">API</abbr> offers, you can also run your own SQL commands against the database. If you want to obtain the three most queries domains for all time, you could use
<div class="codehilite"><pre><span></span><span class="n">sqlite3</span> <span class="ss">&quot;/etc/pihole/pihole-FTL.db&quot;</span> <span class="ss">&quot;SELECT domain,count(domain) FROM queries WHERE (STATUS == 2 OR STATUS == 3) GROUP by domain order by count(domain) desc limit 3&quot;</span>
</pre></div>
which would return something like
<div class="codehilite"><pre><span></span><span class="n">discourse</span><span class="p">.</span><span class="n">pi</span><span class="o">-</span><span class="n">hole</span><span class="p">.</span><span class="n">net</span><span class="o">|</span><span class="mi">421095</span>
<span class="n">www</span><span class="p">.</span><span class="n">pi</span><span class="o">-</span><span class="n">hole</span><span class="p">.</span><span class="n">net</span><span class="o">|</span><span class="mi">132483</span>
<span class="n">posteo</span><span class="p">.</span><span class="n">de</span><span class="o">|</span><span class="mi">130243</span>
</pre></div>
showing the domain and the number of times it was found in the long-term database. Note that such a request might take very long for computation as the entire history of queries have to be processed for this.</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../privacylevels/" title="Privacy levels" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Privacy levels
              </span>
            </div>
          </a>
        
        
          <a href="../telnet-api/" title="Telnet API" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Telnet API
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2018 Pi-hole LLC
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../../assets/fonts/font-awesome.css">
    
      <a href="https://pi-hole.net" class="md-footer-social__link fa fa-globe"></a>
    
      <a href="https://github.com/pi-hole" class="md-footer-social__link fa fa-github-alt"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.39abc4af.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
    
  </body>
</html>